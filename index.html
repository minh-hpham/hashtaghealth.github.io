<!DOCTYPE html>
<html>
<head>
    <title>HashtagHealth Geoportal Beta</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
        /* Always set the map height explicitly to define the size of the div
        * element that contains the map. */
        #map {
            height: 100%;
        }
        /* Optional: Makes the sample page fill the window. */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>

</head>

<body>
    <div id="map"></div>
    <div id="floating-panel">
        <input onclick="remove();" type=button value="Remove shape">
    </div>
    <div id="layers">
        <div id="accordion">
            <h3><strong>Map Layers</strong></h3>
            <div>
                <table></table>
                <br />
                <table>
                    <input id="address" type="textbox" placeholder="County, State">
                    <input type="button" value="Search" onclick="codeAddress()">
                    
                </table>
            </div>
        </div>
    </div>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script async defer
            type="text/javascript"
            src="https://maps.google.com/maps/api/js?key=AIzaSyDRj3S_nk2WIVqQATfqV85DpVBnKI5k5NQ&libraries=geometry,drawing">
    </script>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <script type="text/javascript" src="map.js"></script>
    
    <script type="text/javascript">
        $(function () {
            $("#landmarksKey").dialog({
                autoOpen: false,
                show: {
                    effect: "false",
                    duration: 1000
                },
                hide: {
                    effect: "false",
                    duration: 1000
                }
            });

            $("#opener2").click(function () {
                $("#landmarksKey").dialog("open");
            });
        });
    </script>

    <script type="text/javascript">
        $(function () {
            $("#accordion").accordion();
            $("#dialog").dialog({
                autoOpen: true,
                show: {
                    effect: "blank",
                    duration: 1000
                },
                hide: {
                    effect: "fade",
                    duration: 1000
                }
            }).show();

            $("#dialog2").dialog({
                autoOpen: false,
                show: {
                    effect: "fold",
                    duration: 1000
                },
                hide: {
                    effect: "explode",
                    duration: 1000
                }
            });

            $("#opener").click(function () {
                $("#dialog2").dialog("open");
            });
        });


        function closeSelf() {
            $("#dialog").dialog('close');
            return false;
        };




    </script>

    <script type="text/javascript">

        //Layers Loader

        function loadLayers() {
            for (i = 0; i < layers.length; i++) {
                var c;

                if (!hasCategoty(layers[i].category)) {
                    if (layers[i].category != '') {
                        c = addCategoryUI(layers[i].category, layers[i].name);
                    }
                    else {
                        c = getCategoryContent(layers[i].category);
                    }

                }
                else {
                    c = getCategoryContent(layers[i].category);
                }

                if (layers[i].category != '') {
                    var catTable = c.getElementsByTagName('table')[0];

                    var layerItem = document.createElement('tr');

                    var itemtd = document.createElement('td');

                    var itemin = document.createElement('input');
                    itemin.type = 'checkbox';
                    itemin.name = 'other';
                    itemin.id = layers[i].name;
                    itemin.onclick = showLayer;

                    var itemtd2 = document.createElement('td');
                    itemtd2.innerHTML = layers[i].name;

                    itemtd.appendChild(itemin);
                    layerItem.appendChild(itemtd);
                    layerItem.appendChild(itemtd2);

                    //layerItem.innerHTML = "<td><input onclick='showLayer(\""+layers[i].name+"\")' type='checkbox' name='other' id='"+layers[i].name+"' value='trafficLayer'/></td><td align='left'>"+layers[i].name+"</td>"

                    catTable.appendChild(layerItem);
                }

            }
        }

        loadLayers();

        function showLayer() {
            for (i = 0; i < layers.length; i++) {
                if (layers[i].name == this.id) {
                    if (!this.checked) {
                        layers[i].clearFromMap();
                    }
                    else {
                        layers[i].putOnMap();
                    }
                }
            }
        }

        function getCategoryContent(cat) {
            var accordion = document.getElementById('accordion');
            var e = accordion.getElementsByTagName("h3");

            for (j = 0; j < e.length; j++) {
                if (e[j].textContent == cat) {
                    return accordion.getElementsByTagName('div')[j];
                    break;
                }
                else if (j == e.length) {
                    return false;
                    break;
                }
            }
        }


        function hasCategoty(cat) {
            var accordion = document.getElementById('accordion');
            var e = accordion.getElementsByTagName("h3");

            for (j = 0; j < e.length; j++) {
                if (e[j].textContent == cat) {
                    return true;
                    break;
                }
                else if (j == e.length) {
                    return false;
                    break;
                }
            }
        }

        function addCategoryUI(tag, id) {
            var accordion = document.getElementById('accordion');
            var accorHeader = document.createElement('h3');
            var accorContent = document.createElement('div');

            accorHeader.innerHTML = '<strong>' + tag + '</strong>';
            var contentTable = document.createElement('table');
            accorContent.appendChild(contentTable);

            accordion.appendChild(accorHeader);
            accordion.appendChild(accorContent);

            return accorContent;
        }

        function startVisible(name) {
            for (i = 0; i < layers.length; i++) {
                if (layers[i].name == name) {
                    layers[i].putOnMap();
                    var checkbox = document.getElementById(name);
                    checkbox.checked = true;
                }
            }
        };

    </script>

    <script>
        /*
                // Change this depending on the name of your PHP or XML file
                downloadUrl('https://storage.googleapis.com/mapsdevsite/json/mapmarkers2.xml', function (data) {
                    var xml = data.responseXML;
                    var markers = xml.documentElement.getElementsByTagName('marker');
                    Array.prototype.forEach.call(markers, function (markerElem) {
                        var name = markerElem.getAttribute('name');
                        var address = markerElem.getAttribute('address');
                        var type = markerElem.getAttribute('type');
                        var point = new google.maps.LatLng(
                            parseFloat(markerElem.getAttribute('lat')),
                            parseFloat(markerElem.getAttribute('lng')));

                        var infowincontent = document.createElement('div');
                        var strong = document.createElement('strong');
                        strong.textContent = name
                        infowincontent.appendChild(strong);
                        infowincontent.appendChild(document.createElement('br'));

                        var text = document.createElement('text');
                        text.textContent = address
                        infowincontent.appendChild(text);
                        var icon = customLabel[type] || {};
                        var marker = new google.maps.Marker({
                            map: map,
                            position: point,
                            label: icon.label
                        });
                        marker.addListener('click', function () {
                            infoWindow.setContent(infowincontent);
                            infoWindow.open(map, marker);
                        });
                    });
                });




                function downloadUrl(url, callback) {
                    var request = window.ActiveXObject ?
                        new ActiveXObject('Microsoft.XMLHTTP') :
                        new XMLHttpRequest;

                    request.onreadystatechange = function () {
                        if (request.readyState == 4) {
                            request.onreadystatechange = doNothing;
                            callback(request, request.status);
                        }
                    };

                    request.open('GET', url, true);
                    request.send(null);
                }

                function doNothing() { }
        */
    </script>
    <!--Goolge Analytics Code-->
    <script>


    </script>

</body>
</html>
